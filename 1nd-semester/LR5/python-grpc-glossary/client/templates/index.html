<!DOCTYPE html>
<html>
<head>
    <title>Python Glossary gRPC</title>
    <style>
        .term-card { 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin: 10px; 
            border-radius: 5px; 
            background: #f9f9f9;
        }
        .search-box { 
            margin: 20px 0; 
            padding: 10px; 
            width: 100%; 
            font-size: 16px;
            border: 2px solid #007acc;
            border-radius: 5px;
        }
        .popular-terms {
            margin: 20px 0;
            padding: 15px;
            background: #e7f3ff;
            border-radius: 5px;
        }
        .popular-tag {
            display: inline-block;
            background: #007acc;
            color: white;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 14px;
        }
        .popular-tag:hover {
            background: #005a9e;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', monospace;
        }
        .term-count {
            color: #666;
            font-size: 14px;
            margin: 10px 0;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 5px;
        }
        .debug-info {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üêç Python Glossary (gRPC)</h1>
    
    <div class="debug-info" id="debugInfo">
        –°—Ç–∞—Ç—É—Å: –ó–∞–≥—Ä—É–∑–∫–∞...
    </div>

    <input type="text" id="search" class="search-box" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞...">

    <div class="term-count" id="termCount">-</div>

    <div class="popular-terms">
        <strong>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø:</strong><br>
        <span class="popular-tag" onclick="showTerm('–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è')">–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è</span>
        <span class="popular-tag" onclick="showTerm('–§—É–Ω–∫—Ü–∏—è')">–§—É–Ω–∫—Ü–∏—è</span>
        <span class="popular-tag" onclick="showTerm('–ö–ª–∞—Å—Å')">–ö–ª–∞—Å—Å</span>
        <span class="popular-tag" onclick="showTerm('–û–±—ä–µ–∫—Ç')">–û–±—ä–µ–∫—Ç</span>
        <span class="popular-tag" onclick="showTerm('–°–ø–∏—Å–æ–∫')">–°–ø–∏—Å–æ–∫</span>
        <span class="popular-tag" onclick="showTerm('–°–ª–æ–≤–∞—Ä—å')">–°–ª–æ–≤–∞—Ä—å</span>
        <span class="popular-tag" onclick="showTerm('–ú–æ–¥—É–ª—å')">–ú–æ–¥—É–ª—å</span>
        <span class="popular-tag" onclick="showTerm('–ö–æ—Ä—Ç–µ–∂')">–ö–æ—Ä—Ç–µ–∂</span>
        <span class="popular-tag" onclick="showTerm('–ú–Ω–æ–∂–µ—Å—Ç–≤–æ')">–ú–Ω–æ–∂–µ—Å—Ç–≤–æ</span>
        <span class="popular-tag" onclick="showTerm('–ü–∞–∫–µ—Ç')">–ü–∞–∫–µ—Ç</span>
    </div>
    
    <div id="terms" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤...</div>

<script>
    // –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ GlossaryData (–±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
    const localTerms = [
        {
            "id": 1,
            "term": "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è",
            "definition": "–ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö",
            "examples": "x = 5\nname = 'Python'"
        },
        {
            "id": 2,
            "term": "–§—É–Ω–∫—Ü–∏—è",
            "definition": "–ë–ª–æ–∫ –∫–æ–¥–∞, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É",
            "examples": "def greet(name):\n    return f'Hello {name}'"
        },
        {
            "id": 3,
            "term": "–ö–ª–∞—Å—Å",
            "definition": "–®–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏",
            "examples": "class Dog:\n    def __init__(self, name):\n        self.name = name"
        },
        {
            "id": 4,
            "term": "–û–±—ä–µ–∫—Ç",
            "definition": "–≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç–æ–¥—ã",
            "examples": "my_dog = Dog('Rex')"
        },
        {
            "id": 5,
            "term": "–ú–æ–¥—É–ª—å",
            "definition": "–§–∞–π–ª —Å –∫–æ–¥–æ–º Python, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å",
            "examples": "import math\nfrom datetime import datetime"
        },
        {
            "id": 6,
            "term": "–ü–∞–∫–µ—Ç",
            "definition": "–ö–∞—Ç–∞–ª–æ–≥, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–æ–¥—É–ª–∏ –∏ —Ñ–∞–π–ª __init__.py",
            "examples": "from my_package import my_module"
        },
        {
            "id": 7,
            "term": "–°–ø–∏—Å–æ–∫",
            "definition": "–ò–∑–º–µ–Ω—è–µ–º–∞—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤",
            "examples": "fruits = ['apple', 'banana', 'orange']"
        },
        {
            "id": 8,
            "term": "–ö–æ—Ä—Ç–µ–∂",
            "definition": "–ù–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤",
            "examples": "coordinates = (10, 20)"
        },
        {
            "id": 9,
            "term": "–°–ª–æ–≤–∞—Ä—å",
            "definition": "–ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø–∞—Ä –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ",
            "examples": "person = {'name': 'John', 'age': 30}"
        },
        {
            "id": 10,
            "term": "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ",
            "definition": "–ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤",
            "examples": "unique_numbers = {1, 2, 3, 3, 4}  # {1, 2, 3, 4}"
        }
    ];

    let allTerms = [];

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤
    async function loadTerms() {
        const debugInfo = document.getElementById('debugInfo');
        
        try {
            debugInfo.textContent = '–°—Ç–∞—Ç—É—Å: –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞...';
            
            const response = await fetch('/api/terms');
            console.log('Response status:', response.status);
            
            if (response.ok) {
                const data = await response.json();
                console.log('Server data:', data);
                
                if (data.success && data.terms && data.terms.length > 0) {
                    // –£–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
                    allTerms = data.terms.map(term => {
                        const { category, ...termWithoutCategory } = term;
                        return termWithoutCategory;
                    });
                    debugInfo.textContent = `–°—Ç–∞—Ç—É—Å: –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.terms.length} —Ç–µ—Ä–º–∏–Ω–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞`;
                    showSuccess('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞');
                } else {
                    throw new Error('–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ');
                }
            } else {
                throw new Error(`HTTP error: ${response.status}`);
            }
        } catch (error) {
            console.warn('Server load failed, using local data:', error);
            allTerms = localTerms;
            debugInfo.textContent = `–°—Ç–∞—Ç—É—Å: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (${localTerms.length} —Ç–µ—Ä–º–∏–Ω–æ–≤)`;
            showWarning('–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
        }
        
        displayAllTerms();
        updateTermCount(allTerms.length);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–µ—Ä–º–∏–Ω—ã
    function displayAllTerms() {
        const container = document.getElementById('terms');
        
        if (allTerms.length === 0) {
            container.innerHTML = '<div class="error">–ù–µ—Ç —Ç–µ—Ä–º–∏–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>';
            return;
        }

        container.innerHTML = allTerms.map(term => `
            <div class="term-card">
                <h3>${term.term}</h3>
                <p><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</strong> ${term.definition}</p>
                ${term.examples ? `<p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p><pre><code>${term.examples}</code></pre>` : ''}
                <div style="margin-top: 10px; font-size: 12px; color: #888;">
                    ID: ${term.id}
                </div>
            </div>
        `).join('');
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω
    function showTerm(termName) {
        console.log('Showing term:', termName);
        
        const term = allTerms.find(t => 
            t.term.toLowerCase() === termName.toLowerCase()
        );
        
        if (term) {
            const container = document.getElementById('terms');
            container.innerHTML = `
                <div class="term-card">
                    <h3>${term.term}</h3>
                    <p><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</strong> ${term.definition}</p>
                    ${term.examples ? `<p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p><pre><code>${term.examples}</code></pre>` : ''}
                    <div style="margin-top: 10px; font-size: 12px; color: #888;">
                        ID: ${term.id}
                    </div>
                </div>
                <button onclick="displayAllTerms()" style="margin: 10px; padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫–æ –≤—Å–µ–º —Ç–µ—Ä–º–∏–Ω–∞–º
                </button>
            `;
            updateTermCount(1);
            document.getElementById('search').value = termName;
        } else {
            alert(`–¢–µ—Ä–º–∏–Ω "${termName}" –Ω–µ –Ω–∞–π–¥–µ–Ω!`);
        }
    }

    // –ü–æ–∏—Å–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤
    function searchTerms(query) {
        if (!query || query.trim().length === 0) {
            displayAllTerms();
            updateTermCount(allTerms.length);
            return;
        }

        const results = allTerms.filter(term => 
            term.term.toLowerCase().includes(query.toLowerCase()) ||
            term.definition.toLowerCase().includes(query.toLowerCase())
        );

        const container = document.getElementById('terms');
        
        if (results.length === 0) {
            container.innerHTML = `
                <div class="error">
                    –¢–µ—Ä–º–∏–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è: "${query}"
                </div>
                <button onclick="displayAllTerms()" style="margin: 10px; padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–µ—Ä–º–∏–Ω—ã
                </button>
            `;
        } else {
            container.innerHTML = results.map(term => `
                <div class="term-card">
                    <h3>${term.term}</h3>
                    <p><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:</strong> ${term.definition}</p>
                    ${term.examples ? `<p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p><pre><code>${term.examples}</code></pre>` : ''}
                </div>
            `).join('');
        }
        
        updateTermCount(results.length);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞
    function updateTermCount(count) {
        document.getElementById('termCount').textContent = `–ü–æ–∫–∞–∑–∞–Ω–æ —Ç–µ—Ä–º–∏–Ω–æ–≤: ${count}`;
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showSuccess(message) {
        const debugInfo = document.getElementById('debugInfo');
        debugInfo.style.background = '#d1edff';
        debugInfo.style.color = '#0c5460';
    }

    function showWarning(message) {
        const debugInfo = document.getElementById('debugInfo');
        debugInfo.style.background = '#fff3cd';
        debugInfo.style.color = '#856404';
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    document.getElementById('search').addEventListener('input', (e) => {
        searchTerms(e.target.value.trim());
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Starting glossary application...');
        loadTerms();
    });

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
    window.showTerm = showTerm;
    window.displayAllTerms = displayAllTerms;
</script>
</body>
</html>